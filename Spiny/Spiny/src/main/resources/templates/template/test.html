<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Create New Template</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Gerekirse CSS dosyalarını buraya ekleyebilirsiniz -->
</head>
<body>
<div class="container">
  <!-- Form for creating a new template -->
  <form th:action="@{/template/processTemplate}" method="post" th:object="${template}">
    <div class="mb-3">
      <label for="templateName" class="form-label">Template Name</label>
      <input type="text" id="templateName" class="form-control" th:field="*{name}" placeholder="Enter template name">
    </div>
    <!-- DataField section -->
    <div class="data-fields">
      <!-- DataField input fields will be added dynamically here -->
    </div>
    <button type="button" class="btn btn-primary" onclick="addDataField()">Add DataField</button>
    <!-- Submit button -->
    <button type="submit" class="btn btn-primary">Create Template</button>
  </form>
</div>

<!-- DataField Type options -->
<select id="dataFieldTypeOptions" style="display: none;">
  <option th:each="type : ${dataFieldTypes}" th:value="${type.id}" th:text="${type.type}"></option>
</select>

<script th:inline="javascript">
    function addDataField() {
        var dataFieldIndex = document.querySelectorAll('.data-field').length;
        var dataFieldTypeOptions = document.getElementById('dataFieldTypeOptions').innerHTML;
        var newFieldHtml = `
            <div class="mb-3 data-field">
                <label for="fieldName${dataFieldIndex}" class="form-label">Field Name</label>
                <input type="text" id="fieldName${dataFieldIndex}" class="form-control" th:field="*{dataFields[__${dataFieldIndex}__].name}" placeholder="Enter field name">
                <label for="fieldType${dataFieldIndex}" class="form-label">Field Type</label>
                <select id="fieldType${dataFieldIndex}" class="form-control" th:field="*{dataFields[__${dataFieldIndex}__].dataFieldType.id}">
                    ${dataFieldTypeOptions}
                </select>
                <!-- Add other fields as needed -->
            </div>
        `;
        document.querySelector('.data-fields').insertAdjacentHTML('beforeend', newFieldHtml);
    }
</script>

</body>
</html>
